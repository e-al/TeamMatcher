{% extends 'home.html' %}

{% block container %}
    <div class="top-pad vertical-center-row">
        <h1>{{place}} Projects</h1>
        <input type="radio" name="type" id="nameCheck" value="Name" checked/>Name
        <input type="radio" name="type" id="skillCheck" value="Skill" />Skill
        <input type="text" id="projectSearchInput" onkeyup="searchProj()" placeholder="Search for projects...">

            <table class="table table-hover" id="projUL">
                <thead>
                <tr>
                    <th>Project Name</th>
                    <th>Max. Capacity</th>
                    <th>Description</th>
                    <th>Status</th>
                </tr>
                </thead>
                <tbody>
                {% for project in info %}
                    <tr>
                        <td><a href="/viewproject?proj={{ project['id'] }}">{{ project['name'] }}</a></td>
                        <td>{{ project['max_cap'] }}</td>
                        <td style="text-overflow:ellipsis;overflow:hidden;width:300px;height:90px;display:inline-block">{{ project['desc']}}</td>
                        <th>{{ project['status'] }}</th>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
    </div>
    <script>

        projSkills = {{projSkills|tojson|safe}}

        function searchProj() {
            var input, filter, ul, li, a, i;
            input = document.getElementById('projectSearchInput');
            filter = input.value.toUpperCase();
            ul = document.getElementById('projUL');
            li = ul.getElementsByTagName('tr');
            type = document.getElementById('nameCheck').checked
            if(type)
            {
                for (i = 1; i < li.length; i++) {
                    a = li[i].getElementsByTagName("td")[0].getElementsByTagName("a")[0];
                    if (a.innerHTML.toUpperCase().indexOf(filter) > -1) {
                        li[i].style.display = "";
                    } else {
                        li[i].style.display = "none";
                    }
                }
            }
            else
            {
                for (i = 1; i < li.length; i++) {
                    if(filter == "")
                    {
                        li[i].style.display = "";
                        continue;
                    }
                    a = li[i].getElementsByTagName("td")[0].getElementsByTagName("a")[0];
                    li[i].style.display = "none";
                    skills = projSkills[a.innerHTML];
                    if(skills){
                        skills = [].concat( skills );
                        for(var x = 0; x<skills.length; x++){
                            if (skills[x].toUpperCase().indexOf(filter) > -1) {
                                li[i].style.display = "";
                                break;
                            } else {
                                li[i].style.display = "none";
                            }
                        }
                    }
                }
            }
        }
    </script>
{% endblock %}
